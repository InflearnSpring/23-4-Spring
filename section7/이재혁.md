## ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•

ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í¬ê²Œ 4ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.

- ìƒì„±ì ì£¼ì…
- ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)
- í•„ë“œ ì£¼ì…
- ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

### ìƒì„±ì ì£¼ì…

- ì´ë¦„ ê·¸ëŒ€ë¡œ ìƒì„±ìë¥¼ í†µí•´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•ì´ë‹¤.
- ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ ì§„í–‰í–ˆë˜ ê·¸ ë°©ë²•
- íŠ¹ì§•
    - ìƒì„±ì í˜¸ì¶œì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤
    - ***ë¶ˆë³€, í•„ìˆ˜*** ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©

```java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

### ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)

- setterë¼ ë¶ˆë¦¬ëŠ” í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•ì´ë‹¤.
- íŠ¹ì§•
    - **â€œì„ íƒ, ë³€ê²½â€** ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
    - ìë°”ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```java
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

- ì°¸ê³ : @Autowiredì˜ ê¸°ë³¸ ë™ì‘ì€ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´ @Autowired(required = false)ë¡œ ì§€ì •í•˜ë©´ ëœë‹¤.
- ìë°”ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½
    - ìë°”ì—ì„œëŠ” ê³¼ê±°ë¶€í„° í•„ë“œì˜ ê°’ì„ ì§ì ‘ ë³€ê²½í•˜ì§€ ì•Šê³ , set, get ë¼ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ì„œ ê°’ì„ ì½ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ê·œì¹™ì„ ë§Œë“¤ì—ˆëŠ”ë°, ê·¸ê²ƒì´ ë°”ë¡œ ìë°”ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì´ë‹¤.

### í•„ë“œ ì£¼ì…(field injection is not recommended)

- í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ì‹ì´ë‹¤
- ì•ˆì“°ëŠ”ê²Œ ì¢‹ë‹¤.
    - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ì‹¤í–‰ê³¼ ê´€ë ¨ ì—†ëŠ” í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ê°€ëŠ¥
    - ìŠ¤í”„ë§ ì„¤ì •ì„ ìœ„í•œ @Configuration ê°™ì€ ê³³ì—ì„œë§Œ íŠ¹ë³„í•œ ìš©ë„ë¡œ ì‚¬ìš©í•œë‹¤
- DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤.

### ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

- ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤
- íŠ¹ì§•
    - í•œë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤
    - ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤

```java
@Autowired
    public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
```

- ì°¸ê³ : ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ì´ ì‘ë™í•œë‹¤.

## ì˜µì…˜ ì²˜ë¦¬

ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë•Œê°€ ìˆë‹¤.

ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- @Autowired(required=false) : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œ ì•ˆë¨
- org.springframework.lang.@nullable: ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥ëœë‹¤
- Optional<>: ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ Optional.emptyê°€ ì…ë ¥ëœë‹¤.

```java
package hello.core.autowired;

import hello.core.member.Member;
import jakarta.annotation.Nullable;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.Optional;

public class AutowiredTest {

    @Test
    void AutowiredOption() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(TestBean.class);

    }

    static class TestBean {

        @Autowired(required = false)
        public void setNoBean1(Member noBean1) {
            System.out.println("noBean1 = " + noBean1);
        }

        @Autowired
        public void setNoBean2(@Nullable Member noBean2) {
            System.out.println("noBean2 = " + noBean2);
        }

        @Autowired
        public void setNoBean3(Optional<Member> noBean3) {
            System.out.println("noBean3 = " + noBean3);
        }
    }

}
```

- MemberëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹ˆë‹¤.
- setNoBean1ì€ í˜¸ì¶œì´ ì•ˆëœë‹¤.

## ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!

â€œë¶ˆë³€â€

- ìƒì„±ì ì£¼ì…ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ
    - ë¶ˆë³€í•˜ê²Œ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤.

â€œëˆ„ë½â€

- í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜í•œ ìë°”ì½”ë“œë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²½ìš°ì— ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •ì ì˜ì¡´ê´€ê³„ì¸ ê²½ìš°

â€œì •ë¦¬â€

- ìƒì„±ì ì£¼ì… ë°©ì‹ì„ ì„ íƒí•˜ëŠ” ì´ìœ ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì§€ë§Œ, í”„ë ˆì„ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ìˆœìˆ˜í•œ ìë°” ì–¸ì–´ì˜ íŠ¹ì§•ì„ ì˜ ì‚´ë¦¬ëŠ” ë°©ë²•ì´ê¸°ë„ í•˜ë‹¤.
- ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ê³ , í•„ìˆ˜ ê°’ì´ ì•„ë‹Œ ê²½ìš°ì—ëŠ” ìˆ˜ì •ì ì£¼ì…ì„ ì˜µì…˜ìœ¼ë¡œ ë¶€ì—¬í•˜ë©´ ëœë‹¤. ìƒì„±ì ì£¼ì…ê³¼ ìˆ˜ì •ì ì£¼ì…ì„ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- í•­ìƒ ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼! ê·¸ë¦¬ê³  ê°€ë” ì˜µì…˜ì´ í•„ìš”í•˜ë©´ ìˆ˜ì •ì ì£¼ì…ì„ ì„ íƒí•´ë¼. í•„ë“œ ì£¼ì…ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤.

## ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ëœë“œ

- ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” @RequiredArgsConstructor ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ finalì´ ë¶™ì€ í•„ë“œë¥¼ ëª¨ì•„ì„œ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.

```java
@Component
@RequiredArgsConstructor
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

}
```

â€œì •ë¦¬â€

- ìµœê·¼ì—ëŠ” ìƒì„±ìë¥¼ 1ê°œë§Œ ë‘ê³ , @Autowiredë¥¼ ìƒëµí•˜ëŠ” ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì— Lombokë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ @RequiredArgsConstructor í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ê¸°ëŠ¥ì€ ë‹¤ ì œê³µí•˜ë©´ì„œ, ì½”ë“œëŠ” ê¹”ë”í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ

@AutowiredëŠ” íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ

- í•˜ìœ„ íƒ€ì…ì„ ì§€ì •í•˜ëŠ” ê²ƒì€ DIPë¥¼ ìœ„ë°°í•˜ê³  ìœ ì—°ì„±ì´ ë–¨ì–´ì§„ë‹¤. ê·¸ë¦¬ê³  ì´ë¦„ë§Œ ë‹¤ë¥´ê³ , ì™„ì „íˆ ë˜‘ê°™ì€ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ 2ê°œ ìˆì„ ë•Œ í•´ê²°ì´ ì•ˆëœë‹¤.
- ìŠ¤í”„ë§ ë¹ˆì„ ìˆ˜ë™ ë“±ë¡í•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í•´ë„ ë˜ì§€ë§Œ, ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ì—ì„œ í•´ê²°í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆë‹¤.

## @Autowired í•„ë“œ ëª…, @Qualifier, @Primary

@Autowiredë§¤ì¹­

- íƒ€ì… ë§¤ì¹­
- íƒ€ì… ë§¤ì¹­ì˜ ê²°ê³¼ê°€ 2ê°œ ì´ìƒì¼ í•„ë“œ ëª…, íŒŒë¼ë¯¸í„° ëª…ìœ¼ë¡œ ë¹ˆ ì´ë¦„ ë§¤ì¹­

@Qualifier ì‚¬ìš©

- ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•ì´ë‹¤. ì£¼ì… ì‹œ ì¶”ê°€ì ì¸ ì˜µì…˜ì„ ì œê³µí•˜ëŠ” ê²ƒì´ì§€ ë¹ˆ ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.

```java
@Component
@Qualifier("mainDiscountPolicy")
public class FixDiscountPolicy() {
}
```

@Primary

- ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤. @Autowired ì‹œì— ì—¬ëŸ¬ ë¹ˆì´ ë§¤ì¹­ë˜ë©´ @Primaryê°€ ìš°ì„ ê¶Œì„ ê°€ì§„ë‹¤.

```java
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy {}

@Component
public class FixDiscountPolicy implements DiscountPolicy {}
```

## ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°

```java
package hello.core.annotation;

import org.springframework.beans.factory.annotation.Qualifier;

import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {

}
```

```java
package hello.core.discount;

import hello.core.annotation.MainDiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Component;

@Component
@MainDiscountPolicy
public class RateDiscountPolicy implements DiscountPolicy {

    private int discountPercent = 10;
    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        } else {
            return 0;
        }
    }
}
```

- ì• ë…¸í…Œì´ì…˜ì€ ìƒì†ì´ë¼ëŠ” ê°œë…ì´ ì—†ë‹¤. ì• ë…¸í…Œì´ì…˜ì„ ëª¨ì•„ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì€ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤

## ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map

```java
package hello.core.autowired;

import hello.core.AutoAppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;

import static org.assertj.core.api.Assertions.*;

public class AllBeanTest {
    @Test
    void findAllBean() {
        ApplicationContext ac = new
                AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "userA", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000,
                "fixDiscountPolicy");
        assertThat(discountService).isInstanceOf(DiscountService.class);
        assertThat(discountPrice).isEqualTo(1000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        public DiscountService(Map<String, DiscountPolicy> policyMap,
                               List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);
            System.out.println("discountCode = " + discountCode);
            System.out.println("discountPolicy = " + discountPolicy);
            return discountPolicy.discount(member, price);
        }
    }
}
```

## ìë™, ìˆ˜ë™ì˜ ì˜¬ë°”ë¥¸ ì‹¤ë¬´ ìš´ì˜ ê¸°ì¤€

- í¸ë¦¬í•œ ìë™ ê¸°ëŠ¥ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ì

- ìˆ˜ë™ ë¹ˆ ë“±ë¡ì€ ì–¸ì œ ì‚¬ìš©í•˜ë©´ ì¢‹ì„ê¹Œ?
    - ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í¬ê²Œ ì—…ë¬´ ë¡œì§ê³¼ ê¸°ìˆ  ì§€ì› ë¡œì§ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤
        - ì—…ë¬´ ë¡œì§ ë¹ˆ: ì›¹ì„ ì§€ì›í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬, í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤, ë°ì´í„° ê³„ì¸µì˜ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ ë“±ì´ ëª¨ë‘ ì—…ë¬´ ë¡œì§ì´ë‹¤. ë³´í†µ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ ê°œë°œí•  ë•Œ ì¶”ê°€ë˜ê±°ë‚˜ ë³€ê²½ëœë‹¤.
        - ê¸°ìˆ  ì§€ì› ë¹ˆ: ê¸°ìˆ ì ì¸ ë¬¸ì œë‚˜ ê³µí†µ ê´€ì‹¬ì‚¬(AOP)ë¥¼ ì²˜ë¦¬í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©ëœë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì´ë‚˜, ê³µí†µ ë¡œê·¸ ì²˜ë¦¬ ì²˜ëŸ¼ ì—…ë¬´ ë¡œì§ì„ ì§€ì›í•˜ê¸° ìœ„í•œ í•˜ë¶€ ê¸°ìˆ ì´ë‚˜ ê³µí†µ ê¸°ìˆ ë“¤ì´ë‹¤.
        - ì—…ë¬´ ë¡œì§ì€ ìˆ«ìë„ ë§¤ìš° ë§ê³ , í•œë²ˆ ê°œë°œí•´ì•¼ í•˜ë©´ ì–´ëŠì •ë„ ë¹„ìŠ·í•œ íŒ¨í„´ì´ ìˆë‹¤. ìë™ ê¸°ëŠ¥ì„ ì ê·¹ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤
        - ê¸°ìˆ  ì§€ì› ë¡œì§ì€ ê·¸ ìˆ˜ê°€ ë§¤ìš° ì ê³ , ë³´í†µ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì— ê±¸ì³ì„œ ê´‘ë²”ìœ„í•œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. ê°€ê¸‰ì  ìˆ˜ë™ ë¹ˆì„ ë“±ë¡í•´ì„œ ëª…í™•í•˜ê²Œ ë“¤ì–´ë‚´ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<aside>
ğŸ’¡ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê´‘ë²”ìœ„í•˜ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê¸°ìˆ  ì§€ì› ê°ì²´ëŠ” ìˆ˜ë™ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì„œ ë”±! ì„¤ì • ì •ë³´ì— ë°”ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ í•˜ê¸° ì¢‹ë‹¤

</aside>